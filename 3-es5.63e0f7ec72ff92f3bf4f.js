(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{O3bw:function(t,n,e){"use strict";e.r(n);var a=e("CcnG"),i=function(){return function(){}}(),l=e("pMnS"),o=e("mrSG"),s=e("IY7X"),r=e("Ni3L"),u=e.n(r),h=function(){function t(){}return t.prototype.getDistance=function(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},t.ngInjectableDef=a.Ob({factory:function(){return new t},token:t,providedIn:"root"}),t}(),c=function(){function t(t,n){this.elRef=t,this.touchS=n,this.preview=new a.m,this.scale=1,this.lastDist=0}return t.prototype.ngOnInit=function(){var t=this,n=this;this.stage=new u.a.Stage({draggable:!0,dragBoundFunc:function(t){var e,a,i,l;return n.scale>1?(i=(e=o.__read(n.countPosition(t),2))[0],l=e[1]):(i=(a=o.__read([this.absolutePosition().x,this.absolutePosition().y],2))[0],l=a[1]),console.log(i,l),{x:i,y:l}},scale:{x:this.scale,y:this.scale},width:window.innerWidth,height:window.innerHeight,container:"table-map"}),this.mapLayer=new u.a.Layer,this.stage.add(this.mapLayer),this.tablesLayer=new u.a.Layer,this.stage.add(this.tablesLayer);var e=new Image;e.src="./assets/resto.jpg",e.onload=function(){var n=Math.min(t.stage.width()/e.width,t.stage.height()/e.height);t.mapScale=n,t.stage.width(e.width*n),t.stage.height(e.height*n);var a=new u.a.Image({image:e,x:(t.stage.width()-e.width*n)/2,y:(t.stage.height()-e.height*n)/2,width:e.width*n,height:e.height*n});t.mapLayer.add(a),t.mapLayer.draw(),t.drawTables()},this.stage.getContent().addEventListener("touchmove",function(n){var e=n.touches[0],a=n.touches[1];if(e&&a){var i=t.touchS.getDistance({x:e.clientX,y:e.clientY},{x:a.clientX,y:a.clientY});t.lastDist||(t.lastDist=i),t.scale=t.stage.scaleX()*i/t.lastDist,t.scale=t.scale<1?1:t.scale>4?4:t.scale,t.stage.scale({x:t.scale,y:t.scale}),t.stage.draw(),t.lastDist=i}},!1),this.stage.getContent().addEventListener("touchend",function(){t.lastDist=0},!1),this.tablesLayer.on("click tap",function(n){t.preview.emit(t.tables.find(function(t){return t.id.toString()===n.target.name()}))})},t.prototype.countPosition=function(t){return[t.x>0?0:Math.abs(t.x)>this.stage.width()*this.scale-this.stage.width()?-(this.stage.width()*this.scale-this.stage.width()):t.x,t.y>0?0:Math.abs(t.y)>this.stage.height()*this.scale-this.stage.height()?-(this.stage.height()*this.scale-this.stage.height()):t.y]},t.prototype.drawTables=function(){var t=this;this.tables.forEach(function(n){var e;console.log(n),n.type===s.a.SQUARE||n.type===s.a.POLYGON?e=new u.a.Rect({x:n.position.x*t.mapScale,y:n.position.y*t.mapScale,width:n.position.width*t.mapScale,height:n.position.height*t.mapScale,strokeWidth:1,stroke:"#000",fill:"rgba(0,0,0,0.2)",name:n.id.toString(),rotation:n.position.rotate}):n.type===s.a.ROUND&&(e=new u.a.Circle({x:n.position.x*t.mapScale,y:n.position.y*t.mapScale,strokeWidth:1,stroke:"#000",fill:"rgba(0,0,0,0.2)",name:n.id.toString(),radius:n.position.width/2*t.mapScale})),e&&(t.tablesLayer.add(e),t.tablesLayer.draw())})},t}(),p=a.rb({encapsulation:0,styles:[[""]],data:{}});function b(t){return a.Kb(0,[(t()(),a.tb(0,0,null,null,0,"div",[["id","table-map"]],null,null,null,null,null))],null,null)}var g=e("Ip0R"),d=e("26FU"),f=[{id:1,title:"VIP 21",number:22,count:2,gallery:[],position:{x:350,y:93,width:27,height:60,rotate:90},type:s.a.POLYGON},{id:2,title:"VIP 22",number:22,count:2,gallery:[],position:{x:320,y:290,width:30,height:60,rotate:0},type:s.a.SQUARE},{id:3,title:"VIP 23",number:22,count:2,gallery:[],position:{x:875,y:370,width:90,height:100,rotate:90},type:s.a.ROUND}],w=function(){function t(t){this.table=t}return t.prototype.ngOnInit=function(){},t}(),y=function(){function t(t){this._matDialog=t,this.tables$=new d.a([])}return t.prototype.ngOnInit=function(){this.tables$.next(f)},t.prototype.onPreview=function(t){this._matDialog.open(w,{data:t})},t}(),m=e("o3x0"),v=a.rb({encapsulation:0,styles:[[""]],data:{}});function C(t){return a.Kb(0,[(t()(),a.tb(0,0,null,null,2,"app-client-map",[],null,[[null,"preview"]],function(t,n,e){var a=!0;return"preview"===n&&(a=!1!==t.component.onPreview(e)&&a),a},b,p)),a.sb(1,114688,null,0,c,[a.k,h],{tables:[0,"tables"]},{preview:"preview"}),a.Eb(131072,g.b,[a.h])],function(t,n){var e=n.component;t(n,1,0,a.Jb(n,1,0,a.Db(n,2).transform(e.tables$)))},null)}function x(t){return a.Kb(0,[(t()(),a.tb(0,0,null,null,1,"app-client-plan",[],null,null,null,C,v)),a.sb(1,114688,null,0,y,[m.e],null,null)],function(t,n){t(n,1,0)},null)}var S=a.pb("app-client-plan",y,x,{},{},[]),D=e("t68o"),L=a.rb({encapsulation:0,styles:[[""]],data:{}});function I(t){return a.Kb(0,[(t()(),a.tb(0,0,null,null,2,"p",[],null,null,null,null,null)),(t()(),a.Ib(1,null,["",""])),a.Eb(0,g.f,[])],null,function(t,n){var e=n.component;t(n,1,0,a.Jb(n,1,0,a.Db(n,2).transform(e.table)))})}function P(t){return a.Kb(0,[(t()(),a.tb(0,0,null,null,1,"app-popup-table-info",[],null,null,null,I,L)),a.sb(1,114688,null,0,w,[m.a],null,null)],function(t,n){t(n,1,0)},null)}var k=a.pb("app-popup-table-info",w,P,{},{},[]),O=e("eDkP"),M=e("Fzqc"),j=e("ZYCi"),q=function(){return function(){}}(),E=e("4c35"),R=e("dWZg"),Y=e("qAlS"),N=e("Wf4p"),_=e("ZYjt");e.d(n,"ClientPlanModuleNgFactory",function(){return K});var K=a.qb(i,[],function(t){return a.Bb([a.Cb(512,a.j,a.bb,[[8,[l.a,S,D.a,k]],[3,a.j],a.x]),a.Cb(4608,g.k,g.j,[a.u,[2,g.r]]),a.Cb(4608,O.a,O.a,[O.g,O.c,a.j,O.f,O.d,a.q,a.z,g.d,M.b,[2,g.h]]),a.Cb(5120,O.h,O.i,[O.a]),a.Cb(5120,m.c,m.d,[O.a]),a.Cb(135680,m.e,m.e,[O.a,a.q,[2,g.h],[2,m.b],m.c,[3,m.e],O.c]),a.Cb(1073742336,g.c,g.c,[]),a.Cb(1073742336,j.l,j.l,[[2,j.q],[2,j.k]]),a.Cb(1073742336,q,q,[]),a.Cb(1073742336,M.a,M.a,[]),a.Cb(1073742336,E.f,E.f,[]),a.Cb(1073742336,R.b,R.b,[]),a.Cb(1073742336,Y.b,Y.b,[]),a.Cb(1073742336,O.e,O.e,[]),a.Cb(1073742336,N.b,N.b,[[2,N.a],[2,_.f]]),a.Cb(1073742336,m.h,m.h,[]),a.Cb(1073742336,i,i,[]),a.Cb(1024,j.i,function(){return[[{path:"",component:y}]]},[])])})}}]);