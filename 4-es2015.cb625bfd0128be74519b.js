(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{O3bw:function(t,e,i){"use strict";i.r(e);var n=i("8Y7J");class s{}var a=i("pMnS"),l=function(t){return t.SQUARE="square",t.ROUND="round",t.POLYGON="polygon",t}({}),h=i("Ni3L"),o=i.n(h);let r=(()=>{class t{constructor(){}getDistance(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}}return t.ngInjectableDef=n.Mb({factory:function(){return new t},token:t,providedIn:"root"}),t})();class c{constructor(t,e){this.elRef=t,this.touchS=e,this.preview=new n.m,this.scale=1,this.lastDist=0}ngOnInit(){const t=this;this.stage=new o.a.Stage({draggable:!0,dragBoundFunc:function(e){let i,n;return[i,n]=t.scale>1?t.countPosition(e):[this.absolutePosition().x,this.absolutePosition().y],console.log(i,n),{x:i,y:n}},scale:{x:this.scale,y:this.scale},width:window.innerWidth,height:window.innerHeight,container:"table-map"}),this.mapLayer=new o.a.Layer,this.stage.add(this.mapLayer),this.tablesLayer=new o.a.Layer,this.stage.add(this.tablesLayer);const e=new Image;e.src="./assets/resto.jpg",e.onload=()=>{const t=Math.min(this.stage.width()/e.width,this.stage.height()/e.height);this.mapScale=t,this.stage.width(e.width*t),this.stage.height(e.height*t);const i=new o.a.Image({image:e,x:(this.stage.width()-e.width*t)/2,y:(this.stage.height()-e.height*t)/2,width:e.width*t,height:e.height*t});this.mapLayer.add(i),this.mapLayer.draw(),this.drawTables()},this.stage.getContent().addEventListener("touchmove",t=>{const e=t.touches[0],i=t.touches[1];if(e&&i){const t=this.touchS.getDistance({x:e.clientX,y:e.clientY},{x:i.clientX,y:i.clientY});this.lastDist||(this.lastDist=t),this.scale=this.stage.scaleX()*t/this.lastDist,this.scale=this.scale<1?1:this.scale>4?4:this.scale,this.stage.scale({x:this.scale,y:this.scale}),this.stage.draw(),this.lastDist=t}},!1),this.stage.getContent().addEventListener("touchend",()=>{this.lastDist=0},!1),this.tablesLayer.on("click tap",t=>{this.preview.emit(this.tables.find(e=>e.id.toString()===t.target.name()))})}countPosition(t){let e,i;return[i=t.x>0?0:Math.abs(t.x)>this.stage.width()*this.scale-this.stage.width()?-(this.stage.width()*this.scale-this.stage.width()):t.x,e=t.y>0?0:Math.abs(t.y)>this.stage.height()*this.scale-this.stage.height()?-(this.stage.height()*this.scale-this.stage.height()):t.y]}drawTables(){this.tables.forEach(t=>{let e;console.log(t),t.type===l.SQUARE||t.type===l.POLYGON?e=new o.a.Rect({x:t.position.x*this.mapScale,y:t.position.y*this.mapScale,width:t.position.width*this.mapScale,height:t.position.height*this.mapScale,strokeWidth:1,stroke:"#000",fill:"rgba(0,0,0,0.2)",name:t.id.toString(),rotation:t.position.rotate}):t.type===l.ROUND&&(e=new o.a.Circle({x:t.position.x*this.mapScale,y:t.position.y*this.mapScale,strokeWidth:1,stroke:"#000",fill:"rgba(0,0,0,0.2)",name:t.id.toString(),radius:t.position.width/2*this.mapScale})),e&&(this.tablesLayer.add(e),this.tablesLayer.draw())})}}var u=n.pb({encapsulation:0,styles:[[""]],data:{}});function b(t){return n.Ib(0,[(t()(),n.rb(0,0,null,null,0,"div",[["id","table-map"]],null,null,null,null,null))],null,null)}var p=i("SVse"),g=i("2Vo4");const d=[{id:1,title:"VIP 21",number:22,count:2,gallery:[],position:{x:22,y:22,width:30,height:100,rotate:90},type:l.POLYGON},{id:2,title:"VIP 22",number:22,count:2,gallery:[],position:{x:22,y:22,width:300,height:200,rotate:45},type:l.SQUARE},{id:3,title:"VIP 23",number:22,count:2,gallery:[],position:{x:22,y:22,width:30,height:100,rotate:90},type:l.ROUND}];class w{constructor(t){this.table=t}ngOnInit(){}}class y{constructor(t){this._matDialog=t,this.tables$=new g.a([])}ngOnInit(){this.tables$.next(d)}onPreview(t){this._matDialog.open(w,{data:t})}}var m=i("s6ns"),f=n.pb({encapsulation:0,styles:[[""]],data:{}});function v(t){return n.Ib(0,[(t()(),n.rb(0,0,null,null,2,"app-client-map",[],null,[[null,"preview"]],function(t,e,i){var n=!0;return"preview"===e&&(n=!1!==t.component.onPreview(i)&&n),n},b,u)),n.qb(1,114688,null,0,c,[n.k,r],{tables:[0,"tables"]},{preview:"preview"}),n.Cb(131072,p.b,[n.h])],function(t,e){var i=e.component;t(e,1,0,n.Hb(e,1,0,n.Bb(e,2).transform(i.tables$)))},null)}function A(t){return n.Ib(0,[(t()(),n.rb(0,0,null,null,1,"app-client-plan",[],null,null,null,v,f)),n.qb(1,114688,null,0,y,[m.e],null,null)],function(t,e){t(e,1,0)},null)}var x=n.nb("app-client-plan",y,A,{},{},[]),S=i("t68o"),L=n.pb({encapsulation:0,styles:[[""]],data:{}});function I(t){return n.Ib(0,[(t()(),n.rb(0,0,null,null,2,"p",[],null,null,null,null,null)),(t()(),n.Gb(1,null,["",""])),n.Cb(0,p.f,[])],null,function(t,e){var i=e.component;t(e,1,0,n.Hb(e,1,0,n.Bb(e,2).transform(i.table)))})}function D(t){return n.Ib(0,[(t()(),n.rb(0,0,null,null,1,"app-popup-table-info",[],null,null,null,I,L)),n.qb(1,114688,null,0,w,[m.a],null,null)],function(t,e){t(e,1,0)},null)}var O=n.nb("app-popup-table-info",w,D,{},{},[]),P=i("QQfA"),k=i("IP0z"),M=i("iInd");class N{}var R=i("zMNK"),j=i("/HVE"),E=i("hOhj"),U=i("Xd0L"),q=i("cUpR");i.d(e,"ClientPlanModuleNgFactory",function(){return C});var C=n.ob(s,[],function(t){return n.zb([n.Ab(512,n.j,n.Z,[[8,[a.a,x,S.a,O]],[3,n.j],n.v]),n.Ab(4608,p.k,p.j,[n.s,[2,p.r]]),n.Ab(4608,P.a,P.a,[P.g,P.c,n.j,P.f,P.d,n.p,n.x,p.d,k.b,[2,p.h]]),n.Ab(5120,P.h,P.i,[P.a]),n.Ab(5120,m.c,m.d,[P.a]),n.Ab(135680,m.e,m.e,[P.a,n.p,[2,p.h],[2,m.b],m.c,[3,m.e],P.c]),n.Ab(1073742336,p.c,p.c,[]),n.Ab(1073742336,M.l,M.l,[[2,M.q],[2,M.k]]),n.Ab(1073742336,N,N,[]),n.Ab(1073742336,k.a,k.a,[]),n.Ab(1073742336,R.f,R.f,[]),n.Ab(1073742336,j.b,j.b,[]),n.Ab(1073742336,E.b,E.b,[]),n.Ab(1073742336,P.e,P.e,[]),n.Ab(1073742336,U.b,U.b,[[2,U.a],[2,q.f]]),n.Ab(1073742336,m.h,m.h,[]),n.Ab(1073742336,s,s,[]),n.Ab(1024,M.i,function(){return[[{path:"",component:y}]]},[])])})}}]);